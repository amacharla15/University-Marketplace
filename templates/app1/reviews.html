{% load static %}
<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8">
  <!-- absolutely disable all HTTP + bfcache so you never re-use stale JS or tokens -->
<!-- in <head> -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
  <meta http-equiv="Pragma"        content="no-cache">
  <meta http-equiv="Expires"       content="0">
  <meta name="csrf-token" content="{{ csrf_token }}">
  
  <script>
  // force reload on bfcache
  window.addEventListener('pageshow', e => { if (e.persisted) window.location.reload(); });
  
  // auto-attach CSRF cookie to every non-GET fetch
  function getCookie(name) {
    let v = null;
    document.cookie.split(';').forEach(c => {
      let [k,val]=c.trim().split('='); if (k===name) v=decodeURIComponent(val);
    });
    return v;
  }
  (() => {
    const _f = window.fetch;
    window.fetch = (url, opts={}) => {
      opts.credentials='same-origin';
      opts.headers=opts.headers||{};
      let m=(opts.method||'GET').toUpperCase();
      if (!['GET','HEAD','OPTIONS','TRACE'].includes(m)) {
        opts.headers['X-CSRFToken']=getCookie('csrftoken');
      }
      return _f(url,opts);
    };
  })();
  </script>
  

  <title>Reviews — {{ listing.title }}</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
</head>
<body class="container py-4">

  {% include "app1/_navbar.html" %}

  <h2>Reviews &amp; Ratings for “{{ listing.title }}”</h2>
  <p class="text-muted">
    Coming soon! (You’ll hook up your Review model here.)
  </p>

  <a href="{% url 'detail' listing.pk %}" class="btn btn-link">
    ← Back to listing
  </a>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
